<div class="titleWithBack " id='top'>
    <span class="backBtnImg cursor" (click)="goToLastPage()"><img src="assets/images/backButton.png"></span>
    <h4 class="BackTitle">{{"t.tripDetailInfo" | translate}}</h4>
</div>
<div class="detailPageTrip">
    <div class="tripDetailsLeft">
        <div class="maintopBox ">
            <div class="tripdetailBox ">
                <div class="tripDetails">
                    <div class="tripDetailTopBox relBox">
                        <div class="tripDetailBox">
                            <ul>
                                <li>
                                    <svg width="24" height="24" version="1.1" id="Layer_1"
                                        xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                        x="0px" y="0px" viewBox="0 0 24 24" style="enable-background:new 0 0 24 24;"
                                        xml:space="preserve" class="customOrangeForSvg">
                                        <style type="text/css">
                                            .st0 {
                                                fill: #001E50;
                                            }
                                        </style>
                                        <g>
                                            <path class="st0" d="M12,20.2c-4.5,0-8.2-3.7-8.2-8.2S7.5,3.8,12,3.8s8.2,3.7,8.2,8.2S16.5,20.2,12,20.2z M12,5.2
		c-3.7,0-6.8,3-6.8,6.8c0,3.7,3,6.8,6.8,6.8c3.7,0,6.8-3,6.8-6.8C18.8,8.3,15.7,5.2,12,5.2z" />
                                        </g>
                                        <g>
                                            <path class="st0" d="M12,15.8c-2.1,0-3.8-1.7-3.8-3.8c0-2.1,1.7-3.8,3.8-3.8c2.1,0,3.8,1.7,3.8,3.8C15.8,14.1,14.1,15.8,12,15.8z
		 M12,9.8c-1.2,0-2.2,1-2.2,2.2c0,1.2,1,2.2,2.2,2.2c1.2,0,2.2-1,2.2-2.2C14.2,10.8,13.2,9.8,12,9.8z" />
                                        </g>
                                        <g>
                                            <path class="st0"
                                                d="M12,4.8c-0.4,0-0.8-0.3-0.8-0.8V2c0-0.4,0.3-0.8,0.8-0.8s0.8,0.3,0.8,0.8v2C12.8,4.4,12.4,4.8,12,4.8z" />
                                        </g>
                                        <g>
                                            <path class="st0"
                                                d="M4,12.8H2c-0.4,0-0.8-0.3-0.8-0.8s0.3-0.8,0.8-0.8h2c0.4,0,0.8,0.3,0.8,0.8S4.4,12.8,4,12.8z" />
                                        </g>
                                        <g>
                                            <path class="st0"
                                                d="M12,22.8c-0.4,0-0.8-0.3-0.8-0.8v-2c0-0.4,0.3-0.8,0.8-0.8s0.8,0.3,0.8,0.8v2C12.8,22.4,12.4,22.8,12,22.8z" />
                                        </g>
                                        <g>
                                            <path class="st0"
                                                d="M22,12.8h-2c-0.4,0-0.8-0.3-0.8-0.8s0.3-0.8,0.8-0.8h2c0.4,0,0.8,0.3,0.8,0.8S22.4,12.8,22,12.8z" />
                                        </g>
                                    </svg>

                                    <div class="d-flex mt3">
                                        <p class="fromTitle fromTo mb-0">{{"from" | translate}}: </p>
                                        <div>
                                            <p class="mb-0 fromTitle">&nbsp; {{tripDetail?.start_location_address ||
                                                'NA'}}</p>
                                            <p class="mb-0 timeDesc">&nbsp; {{"startedAt" | translate}}:
                                                {{dateTimeFormat(tripDetail?.start_date_time)}}
                                            </p>
                                        </div>
                                    </div>
                                </li>
                                <li>

                                    <svg width="24" height="24" version="1.1" id="Layer_1"
                                        xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                                        x="0px" y="0px" viewBox="0 0 24 24" style="enable-background:new 0 0 24 24;"
                                        xml:space="preserve" class="customOrangeForSvg">
                                        <style type="text/css">
                                            .st0 {
                                                fill: #604EFF;
                                            }
                                        </style>
                                        <g>
                                            <path class="st0" d="M12,22.8c-1.5,0-3-0.6-4.1-1.7c-2.9-2.8-6.2-7.4-5-12.8v0C4,3.4,8.3,1.2,12,1.2c0,0,0,0,0,0
		c3.7,0,8,2.2,9.1,7.1c1.2,5.4-2,9.9-5,12.7C15,22.2,13.5,22.8,12,22.8z M4.4,8.7C3.3,13.4,6.2,17.4,8.9,20c1.7,1.7,4.4,1.7,6.2,0
		c2.7-2.6,5.6-6.6,4.6-11.3c-1-4.4-4.7-5.9-7.6-5.9c0,0,0,0,0,0C9.1,2.8,5.3,4.3,4.4,8.7L4.4,8.7z" />
                                        </g>
                                        <g>
                                            <path class="st0" d="M10.8,13.8c-0.2,0-0.4-0.1-0.5-0.2L8.7,12c-0.3-0.3-0.3-0.8,0-1.1s0.8-0.3,1.1,0l1,1l3.5-3.5
		c0.3-0.3,0.8-0.3,1.1,0s0.3,0.8,0,1.1l-4,4C11.1,13.7,10.9,13.8,10.8,13.8z" />
                                        </g>
                                    </svg>

                                    <div class="d-flex  mt3">
                                        <p class="fromTitle fromTo mb-0">{{"to" | translate}}: </p>
                                        <div class="">
                                            <p class="mb-0 fromTitle">&nbsp; {{tripDetail?.stop_location_address ||
                                                'NA'}}</p>
                                            <p class="mb-0 timeDesc">&nbsp; {{"endedAt" | translate}}:
                                                {{dateTimeFormat(tripDetail?.stop_date_time)}}</p>

                                            <div class="timeDistBox mt-14">
                                                <svg width="18" height="18" viewBox="0 0 12 12" fill="none"
                                                    xmlns="http://www.w3.org/2000/svg">
                                                    <path
                                                        d="M6 1C3.245 1 1 3.245 1 6C1 8.755 3.245 11 6 11C8.755 11 11 8.755 11 6C11 3.245 8.755 1 6 1ZM8.175 7.785C8.105 7.905 7.98 7.97 7.85 7.97C7.785 7.97 7.72 7.955 7.66 7.915L6.11 6.99C5.725 6.76 5.44 6.255 5.44 5.81V3.76C5.44 3.555 5.61 3.385 5.815 3.385C6.02 3.385 6.19 3.555 6.19 3.76V5.81C6.19 5.99 6.34 6.255 6.495 6.345L8.045 7.27C8.225 7.375 8.285 7.605 8.175 7.785Z"
                                                        fill="#474F5A" />
                                                </svg>
                                                {{"t.totalTime" | translate}}: <span class="timeDistTitle">{{calcTime(tripDetail?.stop_date_time,
                                                    tripDetail?.start_date_time)}}</span>
                                            </div>
                                            <div class="timeDistBox">
                                                <svg width="20" height="20" version="1.1" id="Layer_1"
                                                    xmlns="http://www.w3.org/2000/svg"
                                                    xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
                                                    viewBox="0 0 18 18" style="enable-background:new 0 0 18 18;"
                                                    xml:space="preserve">
                                                    <style type="text/css">
                                                        .st0 {
                                                            fill: #001E50;
                                                        }
                                                    </style>
                                                    <g>
                                                        <path class="st0" d="M4.1,8.1C3.6,8.1,3,7.9,2.6,7.5C1.2,6.2,0.6,4.7,1,3.3c0.4-1.7,1.9-2.4,3.1-2.4c0,0,0,0,0,0
                                               c1.5,0,2.8,1,3.1,2.4C7.6,4.7,7,6.2,5.6,7.5C5.2,7.9,4.6,8.1,4.1,8.1z M4.1,2.1c-0.8,0-1.7,0.4-2,1.5l0,0c-0.2,1,0.2,2,1.3,3
                                               c0.4,0.4,1,0.4,1.4,0c0.7-0.7,1.6-1.8,1.3-3C5.8,2.5,4.8,2.1,4.1,2.1z" />
                                                    </g>
                                                    <g>
                                                        <path class="st0"
                                                            d="M13.9,17.1c-0.5,0-1.1-0.2-1.5-0.6c-1.4-1.3-2-2.8-1.6-4.2c0.4-1.7,1.9-2.4,3.2-2.4c0,0,0,0,0,0
                                               c1.5,0,2.8,1,3.1,2.4c0.3,1.4-0.2,2.9-1.6,4.2C15,16.9,14.4,17.1,13.9,17.1z M13.9,11.1c-0.8,0-1.7,0.4-2,1.5l0,0
                                               c-0.3,1.2,0.5,2.3,1.3,3c0.4,0.4,1,0.4,1.4,0c0.7-0.7,1.6-1.8,1.3-3C15.6,11.5,14.6,11.1,13.9,11.1L13.9,11.1z" />
                                                    </g>
                                                    <g>
                                                        <path class="st0"
                                                            d="M9,14.8H7c-0.9,0-1.7-0.5-2-1.4c-0.3-0.8-0.1-1.7,0.6-2.3l6-5.2c0.4-0.4,0.3-0.9,0.2-1
                                               c-0.1-0.1-0.3-0.6-0.8-0.6H9c-0.3,0-0.6-0.3-0.6-0.6S8.7,3.1,9,3.1h2c0.9,0,1.7,0.5,2,1.4c0.3,0.8,0.1,1.7-0.6,2.3l-6,5.2
                                               c-0.4,0.4-0.3,0.9-0.3,1s0.3,0.6,0.8,0.6h2c0.3,0,0.6,0.3,0.6,0.6S9.3,14.8,9,14.8z" />
                                                    </g>
                                                    <g>
                                                        <path class="st0"
                                                            d="M4.1,4.9c-0.4,0-0.8-0.3-0.8-0.8s0.3-0.7,0.7-0.7h0c0.4,0,0.8,0.3,0.8,0.7S4.5,4.9,4.1,4.9z" />
                                                    </g>
                                                    <g>
                                                        <path class="st0"
                                                            d="M13.9,13.9c-0.4,0-0.8-0.3-0.8-0.8s0.3-0.8,0.7-0.8h0c0.4,0,0.8,0.3,0.8,0.8S14.3,13.9,13.9,13.9z" />
                                                    </g>
                                                </svg>


                                                {{"totalDistance" | translate}}: <span
                                                    class="timeDistTitle">{{service.convertToDutch(tripDetail?.distance)}}
                                                    km</span>
                                            </div>
                                        </div>
                                    </div>
                                </li>
                            </ul>
                        </div>



                    </div>
                </div>
            </div>
            <div class="tripdetailBox h-100">
                <div class="tripDetails h-100">
                    <div class="tripDetailTopBox relBox h-100">

                        <div class="tripDetailBoxes">
                            
                            <div class="tripBoxFields selected-box"
                                *ngIf="tripDetail?.driver_detail?.first_name || tripDetail?.driver_detail?.last_name">
                                <h4 class="tripId"> {{service.convertToDutch(tripDetail?.safe_score) || 'NA'}} </h4>
                                <p class="tripDesc">{{"vehScore" | translate}}</p>
                            </div>
                            <div class="tripBoxFields " *ngIf="tripDetail?.license_plate">
                                <h4 class="tripId">{{tripDetail?.license_plate}}</h4>
                                <p class="tripDesc">{{"v.license" | translate}}</p>
                            </div>
                            
                            <!-- <div class="tripBoxFields" *ngIf="tripDetail?.safe_score">
                            <h4 class="tripId">{{service.convertToDutch(tripDetail?.safe_score)}}</h4>
                            <p class="tripDesc">{{"score" | translate}}</p>
                        </div> -->
                        </div>
                       
                        <div class="dayNightSec">
                            <div class="dayNightBox">
                                <h5 class="dayNightHeading" title='{{"t.nightDriving" | translate}}'>{{"t.nightDriving"
                                    | translate}}</h5>
                                <div class="commonBox night">

                                    <span
                                        class="nightDetail">{{service.convertToHoursMin(tripDetail?.tripDayNightCount?.nightTripMinute)}}</span>
                                </div>
                            </div>
                            <div class="dayNightBox">
                                <h5 class="dayNightHeading" title='{{"t.dayDriving" | translate}}'>{{"t.dayDriving" |
                                    translate}}</h5>
                                <div class="commonBox day">

                                    <span
                                        class="nightDetail">{{service.convertToHoursMin(tripDetail?.tripDayNightCount?.dayTripMinute)}}</span>
                                </div>
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>


        <!-- Speed and road details-->
        <!-- <div class="detailPageTrip"> -->
        <div class="tripDetails ">
            <!-- <div class="tripDetailTopBox"> -->
            <div class="speedRoadSec">
                <div class="speedRoadRight">
                    <div class="scoreBoxRight">
                        <div class="filerHalf">
                            <div class="speedGraphTitle"> {{"t.speedScore"| translate}}</div>
                            <!-- <p class="defaultValue">0</p> -->
                            <ng-container *ngIf="speed !== '1001.0' && speed !== 1001 && speed !== '1001'; else elseTemplate">
                                <ngx-gauge [type]="gaugeType" [value]="speed" [thick]=15 [size]=100 [min]='gaugeMin'
                                    [max]='gaugeMax' [thresholds]="thresholdConfig">
                                </ngx-gauge>
                            </ng-container>
                            <ng-template #elseTemplate>
                                <p class="naData">NA</p>
                            </ng-template>

                        </div>
                        <div class="filerHalf">
                            <div class="speedGraphTitle">{{"t.cornerScore"| translate}}</div>
                            <ng-container *ngIf="cornering !== '1001.0' && cornering !== 1001 && cornering !== '1001'; else elseTemplate">
                                <ngx-gauge [type]="gaugeType" [value]="cornering" [thick]=15 [size]=100 [min]='gaugeMin'
                                    [max]='gaugeMax' [thresholds]="thresholdConfig">
                                </ngx-gauge>
                            </ng-container>
                            <ng-template #elseTemplate>
                                <p class="naData">NA</p>
                            </ng-template>
                        </div>
                    </div>
                </div>
                <div class="speedRoadRight">
                    <div class="scoreBoxRight">
                        <div class="filerHalf">
                            <div class="speedGraphTitle"> {{"t.accScore"| translate}}</div>
                            <ng-container *ngIf="acceleration !== '1001.0' && acceleration !== 1001 && acceleration !== '1001'; else elseTemplate">
                                <ngx-gauge [type]="gaugeType" [value]="acceleration" [thick]=15 [size]=100
                                    [min]='gaugeMin' [max]='gaugeMax' [thresholds]="thresholdConfig">
                                </ngx-gauge>
                            </ng-container>
                            <ng-template #elseTemplate>
                                <p class="naData">NA</p>
                            </ng-template>
                        </div>
                        <div class="filerHalf">
                            <div class="speedGraphTitle"> {{ "t.deaccScore" | translate}}</div>
                            <ng-container *ngIf="braking !== '1001.0' && braking !== 1001 && braking !== '1001'; else elseTemplate">
                                <ngx-gauge [type]="gaugeType" [value]="braking" [thick]=15 [size]=100 [min]='gaugeMin'
                                    [max]='gaugeMax' [thresholds]="thresholdConfig">
                                </ngx-gauge>
                            </ng-container>
                            <ng-template #elseTemplate>
                                <p class="naData">NA</p>
                            </ng-template>
                        </div>

                    </div>
                </div>
                <div class="speedRoadLeft">
                    <div class="scoreBoxGuage h-100">
                        <div class="speedGraphTitle"> {{"idiling" | translate}}</div>
                        <ng-container *ngIf="idling !== '1001.0' && idling !== 1001 && idling !== '1001'; else elseTemplate">
                            <ngx-gauge [type]="gaugeType" [value]="idling" [thick]=15 [size]=100 [min]='gaugeMin'
                                [max]='gaugeMax' [thresholds]="thresholdConfig">
                            </ngx-gauge>
                        </ng-container>
                        <ng-template #elseTemplate>
                            <p class="naData">NA</p>
                        </ng-template>
                    </div>


                </div>

            </div>
            <!-- </div> -->
        </div>
        <div class="tripDetails" [hidden]='!speedProfile.time || !speedProfile.time.length'>
            <div class="tripDetailTopBox">
                <div class="d-flex justify-content-between">
                    <h5 class="graphTitle">{{"t.speedProfile" | translate}}</h5>
                    <div class="graphTab__checkbox">
                        <div class="graphTab__checkbox__safeScore">
                            <div class="checkbox-dynamic activeSafeScore">

                            </div>
                            <label class="form-check-label" for="flexCheckChecked">{{"speed" | translate}} (km/h)</label>
                        </div>

                        <div class="graphTab__checkbox__otherScore">
                            <div class="checkbox-dynamic-second activeOther">

                            </div>
                            <label class="form-check-label text-capitalize" for="flexCheckChecked">
                                {{"limit" | translate}}
                            </label>

                        </div>
                    </div>
                </div>
                <div id='chartDiv' (click)="openChartPopup(speedProfile,1)">
                    <canvas id="myChart"></canvas>
                </div>
            </div>
        </div>
        <div class='mainBox mb-20' [hidden]="!roadTypeData || !roadTypeData.length">
            <h4 class="typeTitle">{{"vehicleDrivenSpeed" | translate}}</h4>
            <div class="speedChart" style="height: 270px">
                <canvas id="roadType"></canvas>
              </div>
        </div>
        <!-- <div class="tripDetails ">
            <div class="tripDetailTopBox">
                <div class="tripDetailBox mb-20">
                    <div class='roadDistribution'>
                        <h4 class="typeTitle"> {{"t.roadDistribution" | translate}}</h4>
                        <ng-container *ngIf="!noRoadTypeData; else elseTemplate2">
                            <div class="mb-28" fxLayout="row" style="width: 100%; height: 15px;">
                                <div *ngFor="let item of showStackBar" fxFlex="{{item.value}}"
                                    [ngStyle]="{'background-color': item?.color}"></div>
                            </div>

                            <div class="getRide">
                                <p *ngFor="let item of showStackBar" [ngClass]="item.class"> {{item.speed}}<span
                                        class="msg"
                                        [ngStyle]="{'background-color': item?.color}">{{service.convertToDutch(item.value)
                                        ||
                                        '0'}}%</span></p>
                            </div>
                        </ng-container>
                        <ng-template #elseTemplate2>
                            <div class="noDataMainBox">
                                <div class="noData"><img src="assets/images/nodata.png"> </div>
                            </div>
                        </ng-template>

                    </div>
                </div>
            </div>
        </div> -->
      

        <div class="tripDetails" [hidden]='!accProfile.time || !accProfile.time.length'>
            <div class="tripDetailTopBox">
                <div class="d-flex justify-content-between">
                    <h5 class="graphTitle">{{"t.accProfile" | translate}}</h5>
                    <div class="graphTab__checkbox">
                        <div class="graphTab__checkbox__safeScore">
                            <div class="checkbox-dynamic activeSafeScore">

                            </div>
                            <label class="form-check-label" for="flexCheckChecked">{{"accelerationprofile" | translate}}</label>
                        </div>

                        <div class="graphTab__checkbox__otherScore">
                            <div class="checkbox-dynamic-second activeOther">

                            </div>
                            <label class="form-check-label text-capitalize" for="flexCheckChecked">
                                {{"breakingprofile" | translate}}
                            </label>

                        </div>
                    </div>
                </div>
                <div id='chartDiv' (click)="openChartPopup(accProfile,2)">
                    <canvas id="myChartAcc"></canvas>
                </div>
            </div>
        </div>
        <div class="tripDetails" [hidden]='!dayNightScore.date || !dayNightScore.date.length'>
            <div class="tripDetailTopBox">
                <div class="d-flex justify-content-between graphTab">
                    <div class="graphTab__title">
                      <h4 class="graphTitle text-center text-capitalize d-inline-block">
                        {{ "dayvsnightdrivingscore" | translate }}
                      </h4>
                      <!-- <img class="pl-3" src="assets/images/newIcons/export.svg"> -->
                    </div>
                    <div class="graphTab__checkbox">
                      <div
                        class="graphTab__checkbox__safeScore"
                        
                      >
                        <div
                          class="checkbox-dynamic"
                         
                        ></div>
                        <label class="form-check-label" for="flexCheckChecked">{{
                          "daydriving" | translate
                        }}</label>
                      </div>
          
                      <div
                        class="graphTab__checkbox__otherScore"
                       
                      >
                        <div
                          class="checkbox-dynamic-second"
                          
                        ></div>
                        <label
                          class="form-check-label text-capitalize"
                          for="flexCheckChecked"
                        >
                          {{ "nightdriving" | translate }}
                        </label>
                      </div>
                    </div>
                  </div>
          
                  <div style="height: 250px" >
                    <canvas id="lineChartScore"></canvas>
                  </div>
            </div>
        </div>

        <!-- </div> -->
        <!-- Speed and road details-->

        <!-- Exceptions during the trip-->
        <!-- <div class="detailPageTrip"> -->
        <div class="tripDetails" *ngIf="exceptionCount">
            <!-- <div class="tripDetailHead">
            <h4 class="tripDetailTitle">{{"t.exceptionDuringTrip" | translate}}</h4>
            <span class="exportRightIcon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M16.19 2H7.81C4.17 2 2 4.17 2 7.81V16.18C2 19.83 4.17 22 7.81 22H16.18C19.82 22 21.99 19.83 21.99 16.19V7.81C22 4.17 19.83 2 16.19 2ZM8.64 12.81L13.02 8.43H10.59C10.18 8.43 9.84 8.09 9.84 7.68C9.84 7.27 10.18 6.93 10.59 6.93H14.83C14.93 6.93 15.02 6.95 15.12 6.99C15.3 7.07 15.45 7.21 15.53 7.4C15.57 7.49 15.59 7.59 15.59 7.69V11.93C15.59 12.34 15.25 12.68 14.84 12.68C14.43 12.68 14.09 12.34 14.09 11.93V9.5L9.7 13.87C9.55 14.02 9.36 14.09 9.17 14.09C8.98 14.09 8.79 14.02 8.64 13.87C8.35 13.58 8.35 13.1 8.64 12.81ZM18.24 17.22C16.23 17.89 14.12 18.23 12 18.23C9.88 18.23 7.77 17.89 5.76 17.22C5.37 17.09 5.16 16.66 5.29 16.27C5.42 15.88 5.84 15.66 6.24 15.8C9.96 17.04 14.05 17.04 17.77 15.8C18.16 15.67 18.59 15.88 18.72 16.27C18.84 16.67 18.63 17.09 18.24 17.22Z"
                        fill="#C5CDD4" />
                </svg>
            </span>
        </div> -->

            <div class="tripHisTop">
                <div class="tripHisTopLeft">
                    <div>
                        <h4 class="tripTitle mb-0 mr-30 d-inline-block"><span class="countValue">({{exceptionCount}}) </span> {{"harshEvent"
                            | translate}}</h4>
                            <svg class="mb-1" width="20" height="20" viewBox="0 0 20 20" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M7.49984 18.3337H12.4998C16.6665 18.3337 18.3332 16.667 18.3332 12.5003V7.50033C18.3332 3.33366 16.6665 1.66699 12.4998 1.66699H7.49984C3.33317 1.66699 1.6665 3.33366 1.6665 7.50033V12.5003C1.6665 16.667 3.33317 18.3337 7.49984 18.3337Z" stroke="#667280" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M8.82471 6.40039H12.358V9.94206" stroke="#667280" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M12.3583 6.40039L7.6416 11.1171" stroke="#667280" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                <path d="M5 13.7588C8.24167 14.8421 11.7583 14.8421 15 13.7588" stroke="#667280" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/>
                                </svg>
                    </div>
                            
                    <!-- <mat-button-toggle-group class="historyButton" [value]='tableView'
                        (change)="toggleChange($event.value)">
                        <mat-button-toggle value="table"> <svg width="20" height="21" viewBox="0 0 20 21" fill="none"
                                xmlns="http://www.w3.org/2000/svg">
                                <path fill-rule="evenodd" clip-rule="evenodd"
                                    d="M18.3332 5.29199C18.3332 5.63717 18.0534 5.91699 17.7082 5.91699H2.29151C1.94633 5.91699 1.6665 5.63717 1.6665 5.29199C1.6665 4.94681 1.94633 4.66699 2.29151 4.66699H17.7082C18.0534 4.66699 18.3332 4.94681 18.3332 5.29199Z"
                                    fill="white" />
                                <path fill-rule="evenodd" clip-rule="evenodd"
                                    d="M18.3332 10.5003C18.3332 10.8455 18.0534 11.1253 17.7082 11.1253H2.2915C1.94633 11.1253 1.6665 10.8455 1.6665 10.5003C1.6665 10.1551 1.94633 9.87532 2.2915 9.87532H17.7082C18.0534 9.87532 18.3332 10.1551 18.3332 10.5003Z"
                                    fill="white" />
                                <path fill-rule="evenodd" clip-rule="evenodd"
                                    d="M18.3332 15.7087C18.3332 16.0538 18.0534 16.3337 17.7082 16.3337H2.2915C1.94633 16.3337 1.6665 16.0538 1.6665 15.7087C1.6665 15.3635 1.94633 15.0837 2.2915 15.0837H17.7082C18.0534 15.0837 18.3332 15.3635 18.3332 15.7087Z"
                                    fill="white" />
                            </svg>
                        </mat-button-toggle>
                        <mat-button-toggle value="map">
                            <svg width="20" height="21" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                                xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20"
                                style="enable-background:new 0 0 20 20;" xml:space="preserve">
                                <style type="text/css">
                                    .st0 {
                                        fill: #C5CDD4;
                                    }
                                </style>
                                <g>
                                    <path class="st0" d="M13,17.8c-0.4,0-0.7-0.1-1-0.2l-4.4-2.2c-0.3-0.1-0.8-0.1-1,0l-2,1.1C3.9,17,3,17.1,2.3,16.7
                           c-0.7-0.4-1-1.2-1-2.1V6.5c0-0.7,0.5-1.6,1.1-2l3.6-2.1c0.6-0.3,1.5-0.4,2.1-0.1l4.4,2.2c0.3,0.1,0.8,0.1,1,0l2-1.1
                           c0.8-0.5,1.7-0.5,2.4-0.2c0.7,0.4,1,1.2,1,2.1v8.1c0,0.7-0.5,1.6-1.1,2l-3.6,2.1C13.9,17.7,13.5,17.8,13,17.8z M7.2,14.1
                           c0.4,0,0.7,0.1,1,0.2l4.4,2.2c0.3,0.1,0.8,0.1,1,0l3.6-2.1c0.3-0.2,0.5-0.6,0.5-0.9V5.4c0-0.5-0.2-0.9-0.4-1.1
                           c-0.3-0.2-0.7-0.1-1.2,0.2l-2,1.1C13.6,5.9,12.7,6,12,5.7L7.7,3.5c-0.3-0.1-0.8-0.1-1,0L3,5.6C2.8,5.7,2.5,6.2,2.5,6.5v8.1
                           c0,0.5,0.2,0.9,0.4,1.1c0.3,0.2,0.7,0.1,1.2-0.2l2-1.1C6.4,14.2,6.8,14.1,7.2,14.1z" />
                                </g>
                                <g>
                                    <path class="st0"
                                        d="M7.1,14.8c-0.3,0-0.6-0.3-0.6-0.6V3.3c0-0.3,0.3-0.6,0.6-0.6S7.7,3,7.7,3.3v10.8C7.7,14.5,7.5,14.8,7.1,14.8z" />
                                </g>
                                <g>
                                    <path class="st0" d="M13.1,17.3c-0.3,0-0.6-0.3-0.6-0.6V5.5c0-0.3,0.3-0.6,0.6-0.6s0.6,0.3,0.6,0.6v11.1
                           C13.7,17,13.4,17.3,13.1,17.3z" />
                                </g>
                            </svg>

                        </mat-button-toggle>
                    </mat-button-toggle-group> -->
                </div>
            </div>

            <div class="tripDetailTopBox">
                <mat-accordion [displayMode]="displayMode" [multi]="multi" id="newcha" class="mat-expansion-Common"
                    #firstAccordion="matAccordion">
                    <mat-expansion-panel #panel1 [hideToggle]="hideToggle" *ngFor="let item of exceptionKeys">
                        <mat-expansion-panel-header>
                            <!-- <div class="driverName">
                                <span>
                                    <svg width="16" height="18" viewBox="0 0 16 18" fill="none"
                                        xmlns="http://www.w3.org/2000/svg">
                                        <path fill-rule="evenodd" clip-rule="evenodd"
                                            d="M3.48522 4.59114L3.95677 4.51355C4.41409 4.43805 4.85814 4.59752 5.16432 4.90273C5.2683 4.97295 5.35866 5.07902 5.42151 5.22537C5.85293 6.23071 6.7895 6.90127 7.85034 7.11146C8.33773 7.20808 9.23049 7.23448 9.59598 6.81523C10.2195 6.10243 11.3052 7.0518 10.6816 7.76459C9.93666 8.61941 8.62131 8.73765 7.57374 8.53016C6.98606 8.41402 6.42474 8.19378 5.92214 7.88439L6.01765 8.46312L3.77837 11.9294C3.4463 11.7256 3.20024 11.385 3.13214 10.9727L2.34114 6.18829C2.21654 5.43425 2.7313 4.7157 3.48533 4.59109L3.48522 4.59114ZM4.42879 0.236084C5.39877 0.236084 6.18499 1.0223 6.18499 1.99228C6.18499 2.96226 5.39877 3.74848 4.42879 3.74848C3.45882 3.74848 2.6726 2.96226 2.6726 1.99228C2.6726 1.0223 3.45882 0.236084 4.42879 0.236084V0.236084ZM0.105487 6.799C-0.0618451 5.86594 1.35684 5.61147 1.5242 6.54499C1.5258 6.55236 1.94824 8.93947 2.34049 10.9437C2.55964 12.0631 3.13457 12.6059 3.91082 12.8319C4.82115 13.097 6.04082 12.9971 7.32741 12.8308C8.26832 12.712 8.44891 14.1418 7.5085 14.2612C6.06118 14.4486 4.6684 14.5542 3.50922 14.2168C2.21609 13.8403 1.26516 12.9749 0.922022 11.221C0.656966 9.86767 0.107331 6.80744 0.105729 6.79958L0.105487 6.799ZM12.2438 3.88965C12.4134 3.14935 13.5395 3.40707 13.3695 4.14734L12.8235 6.52658L15.8146 11.3584C16.2128 12.0031 15.2312 12.6093 14.8331 11.9645L12.4566 8.12551L12.1034 9.66466C11.9338 10.405 10.8077 10.1472 10.9777 9.40697L12.2438 3.88965ZM6.28685 9.80105H9.37985C9.94164 9.80105 10.4095 10.2008 10.5151 10.7314L12.0251 15.8986C12.4476 17.3558 10.2315 17.9979 9.80904 16.5407L8.51592 12.1158H4.85198L6.28553 9.80055L6.28685 9.80105Z"
                                            fill="#474F5A" />
                                    </svg>
                                </span>
                                <span class="dName">{{tripDetail?.driver_detail?.first_name}}
                                    {{tripDetail?.driver_detail?.last_name}}</span>
                            </div> -->

                            <div class="speedingPoint">
                                <span class="speedTitle">{{tripDetail?.license_plate}}: </span>
                                <div class="exceptionName">{{exceptionTypeObj[item]}}</div>
                            </div>

                            <div class="timeSec timewithMin">{{service.convertHMS(exceptionArray[item].total_time)}}
                            </div>
                            <div class="timeSec">{{formatToFixed(exceptionArray[item].distance,2)}} km</div>
                            <div class="timeSec lantlong">{{exceptionArray[item].length}}</div>
                        </mat-expansion-panel-header>
                        <!--map exception data old-->
                        <!-- <div class="mat-expansion-Common-Body" *ngFor="let alert of exceptionArray[item]; let j=index">
                            <div class="matCommon">
                                <p class="timeDateDesc">{{service.formatDateAlert(alert.start_time)}}</p>
                                <p class="timeSecBody speedingPointBody" *ngIf="alert.score_type=='speed'">
                                    {{alert?.violation_rate || '0'}} km/h > {{alert?.limit || '0'}} km/h </p>
                                <p class="timeSecBody speedingPointBody"
                                    *ngIf="alert.score_type=='acceleration' || alert.score_type=='breaking' || alert.score_type=='cornering'">
                                    {{formatToFixed(alert?.violation_rate,1)}} G > {{formatToFixed(alert?.limit,1)}} G
                                </p>
                                <p class="timeSecBody speedingPointBody" *ngIf="alert.score_type=='idling'">
                                    {{service.convertHMS(alert?.violation_rate)}} > {{service.convertHMS(alert?.limit)}}
                                </p>
                                <p class="timeSec timeSecBody">{{service.convertHMS(alert?.duration_seconds)}}</p>
                                <p class="timeSec timeSecBody">{{formatToFixed(alert.distance,2)}} km</p>
                                <p class="timeSec timeSecBody lantlong" *ngIf="alert.points && alert.points.length">
                                    {{formatToFixed(alert.points[0].latitude,2)}}° N,
                                    {{formatToFixed(alert.points[0].longitude,2)}}° E </p>
                            </div>
                            <p class="cursor mapIcon" (click)="singleExceptionShow(alert)"><img
                                    src="assets/images/map-exception.svg"></p>
                        </div>  -->
                        <!--map exception data old-->
                        <div class="mat-expansion-Common-Body" *ngFor="let alert of exceptionArray[item]; let j=index">
                            <div class="exceptionDetail">
                                <p class="exceptionDate">
                                    <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                                        xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20"
                                        style="enable-background:new 0 0 20 20;" xml:space="preserve">
                                        <style type="text/css">
                                            .st0 {
                                                fill: #474F5A;
                                            }
                                        </style>
                                        <g>
                                            <path class="st0" d="M10,19.1c-5,0-9.1-4.1-9.1-9.1S5,0.9,10,0.9S19.1,5,19.1,10S15,19.1,10,19.1z M10,2.4c-4.2,0-7.6,3.4-7.6,7.6
                                       s3.4,7.6,7.6,7.6s7.6-3.4,7.6-7.6S14.2,2.4,10,2.4z" />
                                        </g>
                                        <g>
                                            <path class="st0"
                                                d="M13.1,13.4c-0.1,0-0.3,0-0.4-0.1l-2.6-1.5c-0.7-0.4-1.2-1.3-1.2-2.1V6.3c0-0.4,0.3-0.8,0.8-0.8
                                       s0.8,0.3,0.8,0.8v3.4c0,0.3,0.2,0.7,0.4,0.8l2.6,1.5c0.4,0.2,0.5,0.7,0.3,1C13.6,13.3,13.3,13.4,13.1,13.4z" />
                                        </g>
                                    </svg>
                                    {{dateTimeFormat(alert.start_time)}}
                                </p>
                                <p class="exceptionTitle">
                                    <span *ngIf="alert.score_type=='speed'">{{formatToFixed(alert?.violation_rate,2) || '0'}} km/h >
                                        {{formatToFixed(alert?.limit,2) || '0'}}km/h</span>
                                    <span
                                        *ngIf="alert.score_type=='acceleration' || alert.score_type=='breaking' || alert.score_type=='cornering'">
                                        {{formatToFixed(alert?.violation_rate,1)}} G > {{formatToFixed(alert?.limit,1)}}
                                        G
                                    </span>
                                    <span *ngIf="alert.score_type=='idling'">
                                        {{service.convertHMS(alert?.violation_rate)}} >
                                        {{service.convertHMS(alert?.limit)}}
                                    </span>
                                </p>
                                <p class="exceptionTitle">{{service.convertHMS(alert?.duration_seconds)}}</p>
                                <p class="exceptionTitle">{{formatToFixed(alert.distance,2)}} km</p>
                                <p class="cursor" (click)="singleExceptionShow(alert)"><svg width="20" height="21" version="1.1"
                                        id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                                        xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20"
                                        style="enable-background:new 0 0 20 20;" xml:space="preserve">
                                        <style type="text/css">
                                            .st0 {
                                                fill: #C5CDD4;
                                            }
                                        </style>
                                        <g>
                                            <path class="st0"
                                                d="M13,17.8c-0.4,0-0.7-0.1-1-0.2l-4.4-2.2c-0.3-0.1-0.8-0.1-1,0l-2,1.1C3.9,17,3,17.1,2.3,16.7
                                       c-0.7-0.4-1-1.2-1-2.1V6.5c0-0.7,0.5-1.6,1.1-2l3.6-2.1c0.6-0.3,1.5-0.4,2.1-0.1l4.4,2.2c0.3,0.1,0.8,0.1,1,0l2-1.1
                                       c0.8-0.5,1.7-0.5,2.4-0.2c0.7,0.4,1,1.2,1,2.1v8.1c0,0.7-0.5,1.6-1.1,2l-3.6,2.1C13.9,17.7,13.5,17.8,13,17.8z M7.2,14.1
                                       c0.4,0,0.7,0.1,1,0.2l4.4,2.2c0.3,0.1,0.8,0.1,1,0l3.6-2.1c0.3-0.2,0.5-0.6,0.5-0.9V5.4c0-0.5-0.2-0.9-0.4-1.1
                                       c-0.3-0.2-0.7-0.1-1.2,0.2l-2,1.1C13.6,5.9,12.7,6,12,5.7L7.7,3.5c-0.3-0.1-0.8-0.1-1,0L3,5.6C2.8,5.7,2.5,6.2,2.5,6.5v8.1
                                       c0,0.5,0.2,0.9,0.4,1.1c0.3,0.2,0.7,0.1,1.2-0.2l2-1.1C6.4,14.2,6.8,14.1,7.2,14.1z" />
                                        </g>
                                        <g>
                                            <path class="st0"
                                                d="M7.1,14.8c-0.3,0-0.6-0.3-0.6-0.6V3.3c0-0.3,0.3-0.6,0.6-0.6S7.7,3,7.7,3.3v10.8C7.7,14.5,7.5,14.8,7.1,14.8z" />
                                        </g>
                                        <g>
                                            <path class="st0" d="M13.1,17.3c-0.3,0-0.6-0.3-0.6-0.6V5.5c0-0.3,0.3-0.6,0.6-0.6s0.6,0.3,0.6,0.6v11.1
                                       C13.7,17,13.4,17.3,13.1,17.3z" />
                                        </g>
                                    </svg>
                                </p>
                            </div>
                            <!-- <div class="exceptionDetail">
                                <div class="eventName">
                                    <p class="exceptionTitle">Event: </p>
                                    <p class="exceptiodetail" *ngIf="percentage_of_violation_min==0 || percentage_of_violation_min==null" title="<0 - 05% exeeding limit longer than time">
                                        <0 - 05% exeeding limit longer than time </p>
                                    <p class="exceptiodetail" *ngIf="percentage_of_violation_min==5" title="<05 - 10% exeeding limit longer than time">
                                        <5 - 10% exeeding limit longer than time </p>
                                    <p class="exceptiodetail" *ngIf="percentage_of_violation_min==10" title=">10% exeeding limit longer than time">
                                    >10% exeeding limit longer than time </p>
                                </div>

                                <p class="exceptionTitle">Day driving: <span>1h 24m</span></p>
                                <p class="exceptionTitle">Night driving: <span>1h 24m</span></p>
                            </div> -->
                        </div>

                    </mat-expansion-panel>
                </mat-accordion>
            </div>
        </div>
        <!-- </div> -->


        <!-- Exceptions during the trip-->
    </div>
    <div class="mapShow" id='map'>
        <app-trip-detail-map [tripDetail]='tripDetail' [alerts]='mapAlerts' [singleId]='singleAlertId'
            [hideShowAlerts]='exceptionShowOnMap'></app-trip-detail-map>
    </div>
</div>