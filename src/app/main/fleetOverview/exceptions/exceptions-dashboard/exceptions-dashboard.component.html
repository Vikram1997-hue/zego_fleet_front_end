<!--exception titles-->
<div class="d-flex mb-3 attention">

    <div class="goingGood ">
        <!-- <h2>Going Good</h2> -->
        <div class="d-flex">
            <div class="dataBoxes w-100 ">
                <div class="databoxescolors">
                    {{service.convertToDutch(polarObject?.speed) || '0'}}
                </div>
                <div class="text-center mt-2">
                    <h4 class="p-0 m-0">{{"speeding" | translate}}</h4>
                </div>
            </div>
            <div class="dataBoxes w-100 ">
                <div class="databoxescolors">
                    {{service.convertToDutch(polarObject?.idling) || '0'}}
                </div>
                <div class="text-center mt-2">
                    <h4 class="p-0 m-0">{{"idiling" | translate}}</h4>
                </div>
            </div>
            <div class="dataBoxes w-100 ">
                <div class="databoxescolors">
                    {{service.convertToDutch(polarObject?.breaking) || '0'}}
                </div>
                <div class="text-center mt-2">
                    <h4 class="p-0 m-0">{{"hardBraking" | translate}}</h4>
                </div>
            </div>
            <div class="dataBoxes w-100 ">
                <div class="databoxescolors">
                    {{service.convertToDutch(polarObject?.cornering) || '0'}}
                </div>
                <div class="text-center mt-2">
                    <h4 class="p-0 m-0">{{"harshCorner" | translate}}</h4>
                </div>
            </div>
            <div class="dataBoxes w-100 ">
                <div class="databoxescolors">
                    {{service.convertToDutch(polarObject?.acceleration) || '0'}}
                </div>
                <div class="text-center mt-2">
                    <h4 class="p-0 m-0">{{"hardAcceleration" | translate}}</h4>
                </div>
            </div>
        </div>
    </div>

</div>

<!--exception titles-->

<!-- Exceptions during the trip-->
<div class="detailPage">
    <div class="tripDetails tripDetailFullwidth tripHistory">
        <!-- <div class="tripDetailHead"> -->
        <!-- <h4 class="tripDetailTitle">{{"t.exceptionDuringTrip" | translate}}</h4> -->
        <!-- <span class="exportRightIcon">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path
                        d="M16.19 2H7.81C4.17 2 2 4.17 2 7.81V16.18C2 19.83 4.17 22 7.81 22H16.18C19.82 22 21.99 19.83 21.99 16.19V7.81C22 4.17 19.83 2 16.19 2ZM8.64 12.81L13.02 8.43H10.59C10.18 8.43 9.84 8.09 9.84 7.68C9.84 7.27 10.18 6.93 10.59 6.93H14.83C14.93 6.93 15.02 6.95 15.12 6.99C15.3 7.07 15.45 7.21 15.53 7.4C15.57 7.49 15.59 7.59 15.59 7.69V11.93C15.59 12.34 15.25 12.68 14.84 12.68C14.43 12.68 14.09 12.34 14.09 11.93V9.5L9.7 13.87C9.55 14.02 9.36 14.09 9.17 14.09C8.98 14.09 8.79 14.02 8.64 13.87C8.35 13.58 8.35 13.1 8.64 12.81ZM18.24 17.22C16.23 17.89 14.12 18.23 12 18.23C9.88 18.23 7.77 17.89 5.76 17.22C5.37 17.09 5.16 16.66 5.29 16.27C5.42 15.88 5.84 15.66 6.24 15.8C9.96 17.04 14.05 17.04 17.77 15.8C18.16 15.67 18.59 15.88 18.72 16.27C18.84 16.67 18.63 17.09 18.24 17.22Z"
                        fill="#C5CDD4" />
                </svg>
            </span> -->
        <!-- </div> -->

        <div class="tripHisTop">
            <div class="tripHisTopLeft">
                <h4 class="tripTitle mb-0"><span class="countException">({{service.convertToDutch(totalCount)}}) </span>
                    {{"harshEvent" | translate}}</h4>
                <span class="pl-3"><svg width="20" height="20" viewBox="0 0 20 20" fill="none"
                        xmlns="http://www.w3.org/2000/svg">
                        <path
                            d="M7.49984 18.3332H12.4998C16.6665 18.3332 18.3332 16.6665 18.3332 12.4998V7.49984C18.3332 3.33317 16.6665 1.6665 12.4998 1.6665H7.49984C3.33317 1.6665 1.6665 3.33317 1.6665 7.49984V12.4998C1.6665 16.6665 3.33317 18.3332 7.49984 18.3332Z"
                            stroke="#667280" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                        <path d="M8.82471 6.3999H12.358V9.94157" stroke="#667280" stroke-width="1.5"
                            stroke-linecap="round" stroke-linejoin="round" />
                        <path d="M12.3583 6.3999L7.6416 11.1166" stroke="#667280" stroke-width="1.5"
                            stroke-linecap="round" stroke-linejoin="round" />
                        <path d="M5 13.7583C8.24167 14.8416 11.7583 14.8416 15 13.7583" stroke="#667280"
                            stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                </span>
            </div>
            <mat-button-toggle-group class="historyButton" [value]='tableView' (change)="toggleChange($event.value)">
                <mat-button-toggle value="tableView"> <svg width="20" height="21" viewBox="0 0 20 21" fill="none"
                        xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M18.3332 5.29199C18.3332 5.63717 18.0534 5.91699 17.7082 5.91699H2.29151C1.94633 5.91699 1.6665 5.63717 1.6665 5.29199C1.6665 4.94681 1.94633 4.66699 2.29151 4.66699H17.7082C18.0534 4.66699 18.3332 4.94681 18.3332 5.29199Z"
                            fill="white" />
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M18.3332 10.5003C18.3332 10.8455 18.0534 11.1253 17.7082 11.1253H2.2915C1.94633 11.1253 1.6665 10.8455 1.6665 10.5003C1.6665 10.1551 1.94633 9.87532 2.2915 9.87532H17.7082C18.0534 9.87532 18.3332 10.1551 18.3332 10.5003Z"
                            fill="white" />
                        <path fill-rule="evenodd" clip-rule="evenodd"
                            d="M18.3332 15.7087C18.3332 16.0538 18.0534 16.3337 17.7082 16.3337H2.2915C1.94633 16.3337 1.6665 16.0538 1.6665 15.7087C1.6665 15.3635 1.94633 15.0837 2.2915 15.0837H17.7082C18.0534 15.0837 18.3332 15.3635 18.3332 15.7087Z"
                            fill="white" />
                    </svg>
                </mat-button-toggle>
                <mat-button-toggle value="map">
                    <svg width="20" height="21" version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                        xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20"
                        style="enable-background:new 0 0 20 20;" xml:space="preserve">
                        <style type="text/css">
                            .st0 {
                                fill: #C5CDD4;
                            }
                        </style>
                        <g>
                            <path class="st0" d="M13,17.8c-0.4,0-0.7-0.1-1-0.2l-4.4-2.2c-0.3-0.1-0.8-0.1-1,0l-2,1.1C3.9,17,3,17.1,2.3,16.7
                           c-0.7-0.4-1-1.2-1-2.1V6.5c0-0.7,0.5-1.6,1.1-2l3.6-2.1c0.6-0.3,1.5-0.4,2.1-0.1l4.4,2.2c0.3,0.1,0.8,0.1,1,0l2-1.1
                           c0.8-0.5,1.7-0.5,2.4-0.2c0.7,0.4,1,1.2,1,2.1v8.1c0,0.7-0.5,1.6-1.1,2l-3.6,2.1C13.9,17.7,13.5,17.8,13,17.8z M7.2,14.1
                           c0.4,0,0.7,0.1,1,0.2l4.4,2.2c0.3,0.1,0.8,0.1,1,0l3.6-2.1c0.3-0.2,0.5-0.6,0.5-0.9V5.4c0-0.5-0.2-0.9-0.4-1.1
                           c-0.3-0.2-0.7-0.1-1.2,0.2l-2,1.1C13.6,5.9,12.7,6,12,5.7L7.7,3.5c-0.3-0.1-0.8-0.1-1,0L3,5.6C2.8,5.7,2.5,6.2,2.5,6.5v8.1
                           c0,0.5,0.2,0.9,0.4,1.1c0.3,0.2,0.7,0.1,1.2-0.2l2-1.1C6.4,14.2,6.8,14.1,7.2,14.1z" />
                        </g>
                        <g>
                            <path class="st0"
                                d="M7.1,14.8c-0.3,0-0.6-0.3-0.6-0.6V3.3c0-0.3,0.3-0.6,0.6-0.6S7.7,3,7.7,3.3v10.8C7.7,14.5,7.5,14.8,7.1,14.8z" />
                        </g>
                        <g>
                            <path class="st0" d="M13.1,17.3c-0.3,0-0.6-0.3-0.6-0.6V5.5c0-0.3,0.3-0.6,0.6-0.6s0.6,0.3,0.6,0.6v11.1
                           C13.7,17,13.4,17.3,13.1,17.3z" />
                        </g>
                    </svg>

                </mat-button-toggle>
            </mat-button-toggle-group>

        </div>

        <div class="tripDetailTopBox" *ngIf="tableView=='tableView'">
            <ng-container *ngIf="isDataLoading; else elseTemplate">
                <mat-spinner style="margin: 0 auto;" [diameter]='50'></mat-spinner>
            </ng-container>
            <ng-template #elseTemplate>
                <div class="expSec" *ngFor="let item of filterException ">
                    <div class="expDate mb-20">
                        <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                            xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 25 25"
                            style="enable-background:new 0 0 25 25;" xml:space="preserve">
                            <style type="text/css">
                                .st0 {
                                    fill: #FFFFFF;
                                }
                            </style>
                            <g>
                                <path class="st0"
                                    d="M8.5,6.2c-0.4,0-0.8-0.3-0.8-0.8v-3c0-0.4,0.3-0.8,0.8-0.8s0.8,0.3,0.8,0.8v3C9.2,5.9,8.9,6.2,8.5,6.2z" />
                            </g>
                            <g>
                                <path class="st0"
                                    d="M16.5,6.2c-0.4,0-0.8-0.3-0.8-0.8v-3c0-0.4,0.3-0.8,0.8-0.8s0.8,0.3,0.8,0.8v3C17.2,5.9,16.9,6.2,16.5,6.2z" />
                            </g>
                            <g>
                                <path class="st0"
                                    d="M21,10.3H4c-0.4,0-0.8-0.3-0.8-0.8S3.6,8.8,4,8.8h17c0.4,0,0.8,0.3,0.8,0.8S21.4,10.3,21,10.3z" />
                            </g>
                            <g>
                                <path class="st0" d="M16.5,23.2h-8c-3.7,0-5.8-2.1-5.8-5.8V9c0-3.7,2.1-5.8,5.8-5.8h8c3.7,0,5.8,2.1,5.8,5.8v8.5
                           C22.2,21.2,20.2,23.2,16.5,23.2z M8.5,4.8C5.6,4.8,4.2,6.1,4.2,9v8.5c0,2.9,1.4,4.2,4.2,4.2h8c2.9,0,4.2-1.4,4.2-4.2V9
                           c0-2.9-1.4-4.2-4.2-4.2H8.5z" />
                            </g>
                            <g>
                                <path class="st0"
                                    d="M16.2,15.2c-0.6,0-1-0.4-1-1s0.4-1,1-1h0c0.6,0,1,0.4,1,1S16.8,15.2,16.2,15.2z" />
                            </g>
                            <g>
                                <path class="st0"
                                    d="M16.2,18.2c-0.6,0-1-0.4-1-1s0.4-1,1-1h0c0.6,0,1,0.4,1,1S16.8,18.2,16.2,18.2z" />
                            </g>
                            <g>
                                <path class="st0"
                                    d="M12.5,15.2c-0.6,0-1-0.4-1-1s0.4-1,1-1h0c0.6,0,1,0.4,1,1S13.1,15.2,12.5,15.2z" />
                            </g>
                            <g>
                                <path class="st0"
                                    d="M12.5,18.2c-0.6,0-1-0.4-1-1s0.4-1,1-1h0c0.6,0,1,0.4,1,1S13.1,18.2,12.5,18.2z" />
                            </g>
                            <g>
                                <path class="st0"
                                    d="M8.8,15.2c-0.6,0-1-0.4-1-1s0.4-1,1-1h0c0.6,0,1,0.4,1,1S9.4,15.2,8.8,15.2z" />
                            </g>
                            <g>
                                <path class="st0"
                                    d="M8.8,18.2c-0.6,0-1-0.4-1-1s0.4-1,1-1h0c0.6,0,1,0.4,1,1S9.4,18.2,8.8,18.2z" />
                            </g>
                        </svg>

                        <!-- <img src="assets/images/calendarGray.svg">  -->
                        {{item?.date}}
                    </div>
                    <div class="exceptionSec" *ngFor="let data of item?.data ; let i= index">
                        <div class="driverdetails">
                            <span class="driverName">
                                <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg"
                                    xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 20 20"
                                    style="enable-background:new 0 0 20 20;" xml:space="preserve">
                                    <style type="text/css">
                                        .st0 {
                                            fill: #474F5A;
                                        }
                                    </style>
                                    <g>
                                        <path class="st0" d="M10,19.1c-5,0-9.1-4.1-9.1-9.1S5,0.9,10,0.9S19.1,5,19.1,10S15,19.1,10,19.1z M10,2.4c-4.2,0-7.6,3.4-7.6,7.6
                                   s3.4,7.6,7.6,7.6s7.6-3.4,7.6-7.6S14.2,2.4,10,2.4z" />
                                    </g>
                                    <g>
                                        <path class="st0"
                                            d="M13.1,13.4c-0.1,0-0.3,0-0.4-0.1l-2.6-1.5c-0.7-0.4-1.2-1.3-1.2-2.1V6.3c0-0.4,0.3-0.8,0.8-0.8
                                   s0.8,0.3,0.8,0.8v3.4c0,0.3,0.2,0.7,0.4,0.8l2.6,1.5c0.4,0.2,0.5,0.7,0.3,1C13.6,13.3,13.3,13.4,13.1,13.4z" />
                                    </g>
                                </svg>

                                {{service.formatTime(data?.start_time)}} . {{exceptionTypeObj[data.score_type]}}</span>
                        </div>
                        <div class="speedingPoint">
                            <span class="d-flex ">
                                <span class="cirlce"></span>
                                <span class="licensePlate">{{data?.vehicle?.license_plate}} </span>
                                <!-- <span
                                    class="driver">{{data?.driver_detail?.first_name}}&nbsp;{{data?.driver_detail?.last_name}}</span> -->
                            </span>
                        </div>
                        <div class="timeSec field50Lat" *ngIf="data?.score_type=='speed'">{{service.convertToDutch(data?.violation_rate) ||
                            '0'}} km/h > {{service.convertToDutch(data?.limit) || '0'}} km/h </div>
                        <div class="timeSec field50Lat"
                            *ngIf="data?.score_type=='acceleration' || data?.score_type=='breaking' || data?.score_type=='cornering'">
                            {{formatToFixed(data?.violation_rate,1)}} G > {{formatToFixed(data?.limit,1)}} G</div>
                        <div class="timeSec field50Lat" *ngIf="data?.score_type=='idling'">
                            {{service.convertHMS(data?.violation_rate)}} > {{service.convertHMS(data?.limit)}}</div>

                        <div class="timeSec field25">{{service.convertHMSupdate(data?.duration_seconds)}}</div>
                        <div class="timeSec field25">
                            {{service.convertToDutch(formatToFixed(data?.distance,2)) || '0'}}km
                        </div>
                        <div class="map-icon">
                            <span class="timeSec cursor" (click)="openTripListPage(data)">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="none"
                                    xmlns="http://www.w3.org/2000/svg">
                                    <path
                                        d="M7.62906 3.56969C7.80845 3.47184 7.99906 3.62237 7.99906 3.8267V17.3825C7.99906 17.6058 7.84665 17.7946 7.64926 17.8988C7.64249 17.9024 7.63576 17.906 7.62906 17.9097L5.27906 19.2497C3.63906 20.1897 2.28906 19.4097 2.28906 17.5097V7.77969C2.28906 7.14969 2.73906 6.36969 3.29906 6.04969L7.62906 3.56969Z"
                                        fill="#604EFF" />
                                    <path
                                        d="M14.7219 6.1029C14.8922 6.18725 15 6.36089 15 6.55096V19.7041C15 20.0726 14.615 20.3145 14.283 20.1546L10.033 18.107C9.85998 18.0236 9.75 17.8485 9.75 17.6565V4.4462C9.75 4.07534 10.1396 3.83355 10.4719 3.99814L14.7219 6.1029Z"
                                        fill="#604EFF" />
                                    <path
                                        d="M22 6.49006V16.2201C22 16.8501 21.55 17.6301 20.99 17.9501L17.4986 19.951C17.1653 20.1421 16.75 19.9014 16.75 19.5172V6.33038C16.75 6.15087 16.8462 5.98513 17.0021 5.89615L19.01 4.75006C20.65 3.81006 22 4.59006 22 6.49006Z"
                                        fill="#604EFF" />
                                </svg>

                            </span>
                        </div>
                    </div>
                </div>
            </ng-template>
        </div>
        <div class="tripMap mt-3" *ngIf="tableView=='map'">
            <ng-container *ngIf="isDataLoading; else elseTemplate1">
                <mat-spinner style="margin: 0 auto;" [diameter]='50'></mat-spinner>
            </ng-container>
            <ng-template #elseTemplate1>
                <app-exception-map [tableData]='exceptionArray' [singleMarker]='singleShowIndex'></app-exception-map>
            </ng-template>
        </div>
        <div class="paginate">
            <mat-paginator [length]="totalCount" #paginator [pageSize]="limit" [pageSizeOptions]="pageSizeOptions"
                (page)='pageChange($event)' [showFirstLastButtons]="true">
            </mat-paginator>
        </div>
    </div>
</div>
<!-- Exceptions during the trip-->