{"version":3,"sources":["webpack:///src/app/main/fleetOverview/mapview/mapview-routing.module.ts","webpack:///src/app/main/fleetOverview/mapview/mapview.module.ts","webpack:///src/app/main/fleetOverview/mapview/mapview-dashboard/mapview-dashboard.component.ts","webpack:///src/app/main/fleetOverview/mapview/mapview-dashboard/mapview-dashboard.component.html"],"names":["routes","path","component","pathMatch","MapviewRoutingModule","forChild","imports","exports","MapviewModule","forRoot","extend","declarations","MapviewDashboardComponent","cd","service","router","localService","isCollapsed","vehicleCategoryData","vehicleList","selectedVehicleCategory","selectedVehicle","bounds","google","maps","LatLngBounds","vehicleMarkerList","customeRange","setDate","cancelDate","filterCalledMap","listernerArray","setTimeout","initMap","pipe","subscribe","value","selectedOrgID","getItem","JSON","parse","resetToLastState","filterApply","getSocketToken","getFilter","val","url","split","mapview","next","updatePageData","get","response","access_token","socketUrl","socket","WebSocket","_this","addEventListener","event","dataParse","data","error","searchCategory","stringify","length","categoryId","undefined","searchVehicle","neitherLandCordi","LatLng","netherlandLat","netherlandLong","map","Map","document","getElementById","zoom","center","disableDefaultUI","draggable","scaleControl","zoomControl","zoomControlOptions","style","ZoomControlStyle","SMALL","position","ControlPosition","TOP_RIGHT","fullscreenControl","fullscreenControlOptions","BOTTOM_RIGHT","setOptions","styles","mapStyle","infowindow","InfoWindow","content","color","Math","random","toString","padStart","license_plate","driver_name","road_type","html","extendedHtml","convertToDutch","current_speed","latLng","current_lat","current_long","pre_lat","pre_long","idle_time","vehicle_id","Marker","icon","SymbolPath","CIRCLE","fillColor","fillOpacity","strokeColor","scale","bindInfoWindow","fitBounds","latlng","setIcon","setPosition","animatedMove","marker","vehicleId","removeListener","addListener","setContent","open","close","setZoom","setCenter","getPosition","category","vehicle","setItem","clearOverlays","key","Object","keys","i","setMap","callback","readyState","waitForSocketConnection","timestamp","clearInterval","interval","setInterval","utc","format","send","action","includes","String","updateMarker","createMarker","t","current","moveto","deltalat","lat","deltalng","lng","delay","ind","removeEventListener","console","log","selector","templateUrl","styleUrls","changeDetection","OnPush"],"mappings":"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,YAAM;AAChC,sBAAI,CAACJ,uBAAL,CAA6B,MAAI,CAAClG,MAAlC,EAA0C,YAAY;AACpD,sBAAIM,IAAI,GAAG;AACT,8BAAU,UADD;AAET,6BAASJ,KAAK,CAACpB,aAFN;AAGT,uCAAmByG,QAHV;AAIT,oCAAgBC,OAJP;AAKT,+BAAW,SALF;AAMT,iCAAaW;AANJ,mBAAX;;AAQA,sBAAI7G,GAAG,IAAI,CAAX,EAAc;AACZY,yBAAK,CAACwF,aAAN;AACD;;AACDpG,qBAAG,GAAGA,GAAG,GAAG,CAAZ,CAZoD,CAapD;;AACA6G,2BAAS,GAAG,mCAAM,GAAGI,GAAT,GAAeC,MAAf,CAAsB,mBAAtB,CAAZ;;AACAtG,uBAAK,CAACF,MAAN,CAAayG,IAAb,CAAkBzH,IAAI,CAACyB,SAAL,CAAeH,IAAf,CAAlB;AAED,iBAjBD;AAkBD,eAnB0B,EAmBxB,IAnBwB,CAA3B;AAoBD;AAEF,W,CAED;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;;;;iBAGA,mBAAUF,KAAV,EAAiB;AACfA,iBAAK,GAAGpB,IAAI,CAACC,KAAL,CAAWmB,KAAX,CAAR;;AACA,gBAAIA,KAAK,CAACsG,MAAN,IAAgBtG,KAAK,CAACsG,MAAN,IAAgB,UAAhC,IAA8CtG,KAAK,CAACE,IAAxD,EAA8D;AAC5D,kBAAIA,IAAI,GAAGF,KAAK,CAACE,IAAjB;;AACA,mBAAK,IAAIwF,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGxF,IAAI,CAACI,MAAzB,EAAiCoF,CAAC,EAAlC,EAAsC;AACpC,oBAAI,KAAKO,QAAT,EAAmB;AACjB,sBAAIV,GAAG,GAAGC,MAAM,CAACC,IAAP,CAAY,KAAK1H,iBAAjB,CAAV,CADiB,CAEjB;AACA;;AACA,sBAAIwH,GAAG,CAACgB,QAAJ,CAAaC,MAAM,CAACtG,IAAI,CAACwF,CAAD,CAAJ,CAAQ,YAAR,CAAD,CAAnB,CAAJ,EAAiD;AAC/C,yBAAKe,YAAL,CAAkBvG,IAAI,CAACwF,CAAD,CAAtB,EAD+C,CAE/C;AAED,mBAJD,MAKK;AACH,yBAAKgB,YAAL,CAAkBxG,IAAI,CAACwF,CAAD,CAAtB,EADG,CAEH;AACD;AACF,iBAbD,MAcK;AACH;AACD;AACF;AACF;AACF;;;iBAED,uBAAc;AACZ,iBAAKjI,uBAAL,GAA+B,KAA/B;AACA,iBAAKC,eAAL,GAAuB,KAAvB;AACA,iBAAKqB,WAAL;AACD;;;iBAED,sBAAa0F,MAAb,EAAqBkC,CAArB,EAAwBC,OAAxB,EAAiCC,MAAjC,EAAyC;AACvC,gBAAIC,QAAQ,GAAG,CAACD,MAAM,CAACE,GAAP,KAAeH,OAAO,CAACG,GAAR,EAAhB,IAAiC,GAAhD;AACA,gBAAIC,QAAQ,GAAG,CAACH,MAAM,CAACI,GAAP,KAAeL,OAAO,CAACK,GAAR,EAAhB,IAAiC,GAAhD;AAEA,gBAAIC,KAAK,GAAG,KAAKP,CAAjB;;AACA,iBAAK,IAAIjB,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAG,GAApB,EAAyBA,CAAC,EAA1B,EAA8B;AAC5B,eAAC,UAAUyB,GAAV,EAAe;AACd9I,0BAAU,CACR,YAAY;AACV,sBAAI0I,GAAG,GAAGtC,MAAM,CAAC7C,QAAP,CAAgBmF,GAAhB,EAAV;AACA,sBAAIE,GAAG,GAAGxC,MAAM,CAAC7C,QAAP,CAAgBqF,GAAhB,EAAV;AACAF,qBAAG,IAAID,QAAP;AACAG,qBAAG,IAAID,QAAP;AACA,sBAAI3C,MAAM,GAAG,IAAIzG,MAAM,CAACC,IAAP,CAAY8C,MAAhB,CAAuBoG,GAAvB,EAA4BE,GAA5B,CAAb;AACAxC,wBAAM,CAACF,WAAP,CAAmBF,MAAnB;AACD,iBARO,EAQL6C,KAAK,GAAGC,GARH,CAAV;AAUD,eAXD,EAWGzB,CAXH;AAYD;AAEF;;;iBAED,uBAAW;AACT;AACA;AACA;AACAM,yBAAa,CAAC,KAAKC,QAAN,CAAb;AACA,gBAAI,KAAKrG,MAAT,EACE,KAAKA,MAAL,CAAYwH,mBAAZ,CAAgC,SAAhC,EAA2C,UAAUpH,KAAV,EAAiB;AAC1DqH,qBAAO,CAACC,GAAR,CAAY,SAAZ;AACD,aAFD;AAGH;;;;;;;yBAthBUrK,yB,EAAyB,gI,EAAA,0I,EAAA,uH,EAAA,4I;AAAA,O;;;cAAzBA,yB;AAAyB,8C;AAAA,iB;AAAA,e;AAAA,k9B;AAAA;AAAA;AClBtC;;AACE;;AACE;;AAAI;;;;AAAmC;;AAEvC;;AACG;;AAAA;;AAOC;;AAOA;;AAOA;;AAOA;;AAOF;;AACF;;AACF;;AAEA;;AAAA;;AACE;;AACF;;AACF;;;;AA7CQ;;AAAA;;;;;;;;;;wEDgBKA,yB,EAAyB;gBANrC,uDAMqC;iBAN3B;AACTsK,oBAAQ,EAAE,uBADD;AAETC,uBAAW,EAAE,oCAFJ;AAGTC,qBAAS,EAAE,CAAC,oCAAD,CAHF;AAITC,2BAAe,EAAE,sEAAwBC;AAJhC,W;AAM2B,U","file":"fleetOverview-mapview-mapview-module-es5.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { Routes, RouterModule } from '@angular/router';\nimport { MapviewDashboardComponent } from './mapview-dashboard/mapview-dashboard.component';\n\nconst routes: Routes = [\n  {\n    path: \"\",\n    component: MapviewDashboardComponent,\n    pathMatch: 'full'\n  }\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule]\n})\nexport class MapviewRoutingModule { }\n","import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\n\nimport { MapviewRoutingModule } from './mapview-routing.module';\nimport { MapviewDashboardComponent } from './mapview-dashboard/mapview-dashboard.component';\nimport { FormsModule } from '@angular/forms';\nimport { NgbModule } from '@ng-bootstrap/ng-bootstrap';\nimport { TranslateModule } from '@ngx-translate/core';\nimport { NgxDaterangepickerMd } from 'ngx-daterangepicker-material';\nimport { MaterialModules } from 'src/app/config/material';\nimport { SharedModule } from 'src/app/shared/shared.module';\nimport { NgxShimmerLoadingModule } from 'ngx-shimmer-loading';\n\n\n@NgModule({\n  declarations: [MapviewDashboardComponent],\n  imports: [\n    CommonModule,\n    MapviewRoutingModule,\n    FormsModule,\n    SharedModule,\n    NgxDaterangepickerMd.forRoot(),\n    MaterialModules,\n    NgbModule,\n    TranslateModule.forChild({\n      extend: true\n    }),\n    NgxShimmerLoadingModule,\n  ]\n})\nexport class MapviewModule { }\n","import { ChangeDetectionStrategy, ChangeDetectorRef, Component, OnInit } from '@angular/core';\nimport { Router } from '@angular/router';\nimport { AppConfig } from 'src/app/config/app-config';\nimport { LocalService } from 'src/app/services/local.service';\nimport { MainService } from 'src/app/services/main.service';\nimport { environment as ENV } from '../../../../../environments/environment';\nimport * as moment from 'moment';\nimport { RouteConfig } from 'src/app/config/route-config';\nimport { Subject } from 'rxjs';\nimport { debounceTime } from 'rxjs/operators';\n\ndeclare var google;\n\n@Component({\n  selector: 'app-mapview-dashboard',\n  templateUrl: './mapview-dashboard.component.html',\n  styleUrls: ['./mapview-dashboard.component.scss'],\n  changeDetection: ChangeDetectionStrategy.OnPush\n})\nexport class MapviewDashboardComponent implements OnInit {\n  public isCollapsed = true;\n\n  map;\n  selectedOrgID: any;\n  searchString: string;\n\n  searchCategory: string;\n  searchVehicle: string;\n\n  vehicleCategoryData: any = [];\n  vehicleList: any = [];\n\n  selectedVehicleCategory: any = 'all';\n  selectedVehicle: any = 'all';\n  bounds = new google.maps.LatLngBounds();\n\n  vehicleMarkerList: any = {};\n  socket;\n  colorsVariable: any;\n  customeRange='Custom';\n  setDate='Set Date';\n  cancelDate='Cancel';\n  filterCalledMap = new Subject();\n\n  constructor(private cd: ChangeDetectorRef,\n    public service: MainService,\n    private router: Router,\n    private localService: LocalService) { }\n  ngOnInit(): void {\n    this.filterCalledMap = new Subject();\n\n    setTimeout(() => {\n      this.initMap()\n    }, 20)\n\n    this.filterCalledMap.pipe(\n      debounceTime(500),\n    ).subscribe(\n      value => {\n        if(value){\n          this.selectedOrgID = this.localService.getItem(\"selectedOrgs\")\n          if (this.selectedOrgID) {\n            this.selectedOrgID = JSON.parse(this.selectedOrgID);\n          }\n          this.resetToLastState();\n          this.filterApply();\n        }\n      }\n    )\n\n\n    this.getSocketToken()\n\n    this.localService.getFilter().subscribe((val)=>{\n      if(val  && this.router.url.split('?')[0] == RouteConfig.mapview.url){\n        this.filterCalledMap.next(true)\n      }\n    })\n\n    this.selectedOrgID = this.localService.getItem(\"selectedOrgs\")\n    if (this.selectedOrgID) {\n      this.selectedOrgID = JSON.parse(this.selectedOrgID);\n    }\n    if (this.selectedOrgID) {\n      this.resetToLastState();\n      this.updatePageData()\n    }\n  }\n\n  getSocketToken() {\n    this.service.get(`validateSocket`).pipe().subscribe(response => {\n      if (response.access_token) {\n        let url = ENV.socketUrl + '?token=' + response.access_token\n        this.socket = new WebSocket(url);\n\n        let _this = this;\n        this.socket.addEventListener('message', function (event) {\n          \n          _this.dataParse(event.data)\n        });\n        this.socket.addEventListener('close', function (event) {\n          // console.log('The connection has been closed');\n        });\n      }\n    }, (error) => {\n\n    })\n\n  }\n\n\n  getVehicleCategory() {\n    this.searchCategory = '';\n    this.service.get(`vehicles/category-by-organisation?organisation=${JSON.stringify(this.selectedOrgID)}`).pipe().subscribe(response => {\n      if (response.data && response.data.length) {\n        this.vehicleCategoryData = response.data;\n        this.selectedVehicleCategory = 'all';\n      }\n    }, (error) => {\n\n    })\n  }\n\n  getVehicles(categoryId?) {\n    if ((categoryId && categoryId == 'all') || categoryId == undefined) {\n      categoryId = ''\n    }\n    this.searchVehicle = '';\n    this.service.get(`vehicles/by-organisation?organisation=${JSON.stringify(this.selectedOrgID)}`).pipe().subscribe(response => {\n      if (response.data && response.data.length) {\n        this.vehicleList = response.data;\n        this.selectedVehicle = 'all';\n      }\n    }, (error) => {\n\n    })\n  }\n\n  initMap() {\n    var neitherLandCordi = new google.maps.LatLng(AppConfig.netherlandLat, AppConfig.netherlandLong);\n    this.map = new google.maps.Map(document.getElementById('map'), {\n      zoom: 8,\n      center: neitherLandCordi,\n      disableDefaultUI: true,\n      draggable: true,\n      scaleControl: true,\n      zoomControl: true,\n      zoomControlOptions: {\n        style: google.maps.ZoomControlStyle.SMALL,\n        position: google.maps.ControlPosition.TOP_RIGHT\n      },\n      fullscreenControl: true,\n      fullscreenControlOptions: {\n        style: google.maps.ZoomControlStyle.SMALL,\n        position: google.maps.ControlPosition.BOTTOM_RIGHT\n      },\n    });\n    this.map.setOptions({ styles: AppConfig.mapStyle });\n  }\n\n  createMarker(data) {\n    var infowindow = new google.maps.InfoWindow({\n      content: ''\n    });\n    let color = '#' + (Math.random() * 0xFFFFFF << 0).toString(16).padStart(6, '0');\n    if (!data.license_plate || data.license_plate == 'null') {\n      data.license_plate = 'NA'\n    }\n    data.driver_name = data.driver_name ? data.driver_name : \"NA\";\n    data.road_type = data.road_type ? data.road_type : \"NA\";\n    let html = `\n    <div style=\"display:flex; flex-wrap:wrap; justify-content: space-between; align-items:center; padding:5px 0;\">\n    <div style=\"padding:10px; width:145px; text-align:center; background: rgba(71, 79, 90, 0.05);\n    border-radius: 8px; font: 600 12px/18px ModernEra; color:#474F5A; margin-right:10px\">\n        License: <span style=\"color:#474F5A; font: 600 14px/18px ModernEra; margin-left:6px\">${data.license_plate}</span>\n    </div>\n    `\n    let extendedHtml = `\n    <div>\n        <div style=\"padding:10px; width:185px; text-align:center; background: rgba(71, 79, 90, 0.05);\n    border-radius: 8px; font: 600 12px/18px ModernEra; color:#474F5A\">\n        Speed: <span style=\"color:#474F5A; font: 600 14px/18px ModernEra; margin-left:6px\">${this.service.convertToDutch(data.current_speed)} kmph</span>\n    </div>\n    </div>`\n    var latLng = new google.maps.LatLng(data.current_lat, data.current_long);\n    if (data.pre_lat == data.current_lat && data.pre_long == data.current_long || data.idle_time > 120) {\n      html = html + `</div>`;\n      this.vehicleMarkerList[data.vehicle_id] = new google.maps.Marker({\n        position: latLng,\n        icon: {\n          path: google.maps.SymbolPath.CIRCLE,\n          fillColor: color,\n          fillOpacity: 1,\n          strokeColor: color,\n          scale: 6\n        },\n        map: this.map,\n      });\n    }\n    else {\n      html = html + extendedHtml + `</div>`;\n      this.vehicleMarkerList[data.vehicle_id] = new google.maps.Marker({\n        position: latLng,\n        icon: {\n          path: 'M21.134 4.5C21.5189 3.83333 22.4811 3.83333 22.866 4.5L31.134 18.8205C31.5189 19.4872 31.0378 20.3205 30.268 20.3205H13.7321C12.9622 20.3205 12.4811 19.4872 12.866 18.8205L21.134 4.5Z',\n          fillColor: color,\n          fillOpacity: 1,\n          strokeColor: color,\n          scale: 1\n        },\n        map: this.map,\n      });\n    }\n\n    this.bindInfoWindow(this.vehicleMarkerList[data.vehicle_id], this.map, infowindow, html, data.vehicle_id);\n    this.bounds.extend(latLng);\n    this.map.fitBounds(this.bounds);\n\n  }\n\n\n  updateMarker(data) {\n    var latlng = new google.maps.LatLng(data.current_lat, data.current_long);\n    let color = this.vehicleMarkerList[data.vehicle_id].icon.fillColor;\n\n    var infowindow = new google.maps.InfoWindow({\n      content: ''\n    });\n    if (!data.license_plate || data.license_plate == 'null') {\n      data.license_plate = 'NA'\n    }\n    data.driver_name = data.driver_name ? data.driver_name : \"NA\";\n    data.road_type = data.road_type ? data.road_type : \"NA\";\n\n    let html = `\n    <div style=\"display:flex; flex-wrap:wrap; justify-content: space-between; align-items:center; padding:5px 0;\">\n    <div style=\"padding:10px; width:145px; text-align:center; background: rgba(71, 79, 90, 0.05);\n    border-radius: 8px; font: 600 12px/18px ModernEra; color:#474F5A; margin-right:10px\">\n        License: <span style=\"color:#474F5A; font: 600 14px/18px ModernEra; margin-left:6px\">${data.license_plate}</span>\n    </div>\n    `\n    let extendedHtml = `\n    <div>\n        <div style=\"padding:10px; width:185px; text-align:center; background: rgba(71, 79, 90, 0.05);\n    border-radius: 8px; font: 600 12px/18px ModernEra; color:#474F5A\">\n    Speed: <span style=\"color:#474F5A; font: 600 14px/18px ModernEra; margin-left:6px\">${this.service.convertToDutch(data.current_speed)} kmph</span>\n    </div>\n    </div>`\n    if ((data.pre_lat == data.current_lat && data.pre_long == data.current_long || data.idle_time > 120)) {\n      html = html + `</div>`;\n      this.vehicleMarkerList[data.vehicle_id].setIcon({\n        path: google.maps.SymbolPath.CIRCLE,\n        fillColor: color,\n        fillOpacity: 1,\n        strokeColor: color,\n        scale: 6\n      })\n      this.vehicleMarkerList[data.vehicle_id].setPosition(latlng);\n    }\n    else {\n      html = html + extendedHtml + `</div>`;\n      this.vehicleMarkerList[data.vehicle_id].setIcon({\n        path: 'M21.134 4.5C21.5189 3.83333 22.4811 3.83333 22.866 4.5L31.134 18.8205C31.5189 19.4872 31.0378 20.3205 30.268 20.3205H13.7321C12.9622 20.3205 12.4811 19.4872 12.866 18.8205L21.134 4.5Z',\n        fillColor: color,\n        fillOpacity: 1,\n        strokeColor: color,\n        scale: 1\n      })\n      this.animatedMove(this.vehicleMarkerList[data.vehicle_id], .5, this.vehicleMarkerList[data.vehicle_id].position, latlng);\n    }\n    this.bindInfoWindow(this.vehicleMarkerList[data.vehicle_id], this.map, infowindow, html, data.vehicle_id);\n    // this.bounds.extend(latlng);\n    // this.map.fitBounds(this.bounds);\n  }\n\n\n  listernerArray: any = {};\n  bindInfoWindow(marker, map, infowindow, html, vehicleId) {\n    if (this.listernerArray[vehicleId]) {\n      google.maps.event.removeListener(this.listernerArray[vehicleId]);\n    }\n\n    this.listernerArray[vehicleId] = google.maps.event.addListener(marker, 'mouseover', function () {\n      infowindow.setContent(html);\n      infowindow.open(map, marker);\n    });\n    google.maps.event.addListener(marker, 'mouseout', function () {\n      infowindow.close();\n    });\n\n    google.maps.event.addListener(marker, 'dblclick', function () {\n      map.setZoom(12);\n      map.setCenter(marker.getPosition());\n    });\n  }\n\n\n  resetToLastState() {\n    let category = this.localService.getItem(\"category\")\n    let vehicle = this.localService.getItem(\"vehicle\")\n    category && category !== 'all' ? this.selectedVehicleCategory = JSON.parse(category) : this.selectedVehicleCategory = 'all';\n    vehicle && vehicle !== 'all' ? this.selectedVehicle = vehicle : this.selectedVehicle = 'all';\n  }\n\n  filterApply() {\n    this.localService.setItem(\"category\", this.selectedVehicleCategory)\n    this.localService.setItem(\"vehicle\", this.selectedVehicle)\n    this.clearOverlays();\n    this.updatePageData();\n  }\n\n  clearOverlays() {\n    let key = Object.keys(this.vehicleMarkerList)\n    for (var i = 0; i < key.length; i++) {\n      this.vehicleMarkerList[key[i]].setMap(null);\n    }\n    this.vehicleMarkerList = {};\n  }\n\n  waitForSocketConnection(socket, callback) {\n    let _this = this;\n    setTimeout(\n      function () {\n        if (socket && socket.readyState === 1) {\n          // console.log(\"Connection is made\")\n          if (callback != null) {\n            callback();\n          }\n        } else {\n          // console.log(\"wait for connection...\")\n          _this.waitForSocketConnection(socket, callback);\n        }\n\n      }, 5); // wait 5 milisecond for the connection...\n  }\n  interval;\n  updatePageData() {\n    let _this = this;\n    let category = [];\n    let vehicle = [];\n    if ((this.selectedVehicle && this.selectedVehicle !== 'all')) {\n      vehicle = [this.selectedVehicle]\n    }\n    else {\n      if ((this.selectedVehicleCategory && this.selectedVehicleCategory !== 'all')) {\n        category = [this.selectedVehicleCategory]\n      }\n    }\n\n    // this.getDashboardData();\n    let timestamp = '';\n\n    if (this.map) {\n      this.map.setCenter(new google.maps.LatLng(AppConfig.netherlandLat, AppConfig.netherlandLong))\n      this.map.setZoom(8)\n    }\n\n    clearInterval(this.interval)\n    let val = 0;\n    // this.listernerArray = {};\n    if (this.selectedOrgID.length) {\n      // Wait until the state of the socket is not ready and send the message when it is...\n      this.interval = setInterval(() => {\n        this.waitForSocketConnection(this.socket, function () {\n          let data = {\n            \"action\": \"liveFeed\",\n            \"orgId\": _this.selectedOrgID,\n            \"vehicleCategory\": category,\n            \"licensePlate\": vehicle,\n            \"message\": \"testing\",\n            \"timestamp\": timestamp\n          }\n          if (val == 0) {\n            _this.clearOverlays();\n          }\n          val = val + 1;\n          // console.log(\"message sent!!!\", data);\n          timestamp = moment().utc().format(\"yyyy-M-D hh:mm:ss\");\n          _this.socket.send(JSON.stringify(data))\n\n        });\n      }, 2000)\n    }\n\n  }\n\n  // dashBoardData: any = {}\n  // isLoadingshimmer = false;\n  // getDashboardData() {\n  //   this.isLoadingshimmer = true;\n  //   let querryParams = this.createQuerryparams()\n  //   this.service.get(`zego/dashboard/activity-count-v2?${querryParams}`).pipe().subscribe(response => {\n  //     if (response.data) {\n  //       this.dashBoardData = response.data;\n  //       this.dashBoardData[\"safeScoreChange\"] = parseFloat(\n  //         this.dashBoardData.pre_safe_score\n  //       ) !== 1001 && parseFloat(\n  //         this.dashBoardData.pre_safe_score\n  //       ) !== 0 && parseFloat(\n  //         this.dashBoardData.safe_score\n  //       ) !== 1001\n  //         ? ((parseFloat(this.dashBoardData.safe_score) -\n  //           parseFloat(this.dashBoardData.pre_safe_score)) /\n  //           parseFloat(this.dashBoardData.pre_safe_score)) *\n  //         100\n  //         : 0;\n\n  //       this.dashBoardData[\"driverChange\"] = parseFloat(\n  //         this.dashBoardData.pre_total_drivers\n  //       ) !== 1001 && parseFloat(\n  //         this.dashBoardData.pre_total_drivers\n  //       ) !== 0 && parseFloat(\n  //         this.dashBoardData.total_drivers\n  //       ) !== 1001\n  //         ? ((parseFloat(this.dashBoardData.total_drivers) -\n  //           parseFloat(this.dashBoardData.pre_total_drivers)) /\n  //           parseFloat(this.dashBoardData.pre_total_drivers)) *\n  //         100\n  //         : 0;\n\n  //       this.dashBoardData[\"tripChange\"] = parseFloat(\n  //         this.dashBoardData.pre_total_trips\n  //       ) !== 1001 && parseFloat(\n  //         this.dashBoardData.pre_total_trips\n  //       ) !== 0 && parseFloat(\n  //         this.dashBoardData.total_trips\n  //       ) !== 1001\n  //         ? ((parseFloat(this.dashBoardData.total_trips) -\n  //           parseFloat(this.dashBoardData.pre_total_trips)) /\n  //           parseFloat(this.dashBoardData.pre_total_trips)) *\n  //         100\n  //         : 0;\n\n  //       this.dashBoardData[\"vehicleChange\"] = parseFloat(\n  //         this.dashBoardData.pre_total_drivers\n  //       ) !== 1001 && parseFloat(\n  //         this.dashBoardData.pre_total_drivers\n  //       ) !== 0 && parseFloat(\n  //         this.dashBoardData.total_vehicles\n  //       ) !== 1001\n  //         ? ((parseFloat(this.dashBoardData.total_vehicles) -\n  //           parseFloat(this.dashBoardData.pre_total_vehicles)) /\n  //           parseFloat(this.dashBoardData.pre_total_vehicles)) *\n  //         100\n  //         : 0;\n\n  //       this.dashBoardData[\"exceptionChange\"] = parseFloat(\n  //         this.dashBoardData.pre_exception\n  //       ) !== 1001 && parseFloat(\n  //         this.dashBoardData.pre_exception\n  //       ) !== 0 && parseFloat(\n  //         this.dashBoardData.exception\n  //       ) !== 1001\n  //         ? ((parseFloat(this.dashBoardData.exception) -\n  //           parseFloat(this.dashBoardData.pre_exception)) /\n  //           parseFloat(this.dashBoardData.pre_exception)) *\n  //         100\n  //         : 0;\n\n  //       this.dashBoardData[\"distanceChange\"] = parseFloat(\n  //         this.dashBoardData.pre_total_distance\n  //       ) !== 1001 && parseFloat(\n  //         this.dashBoardData.pre_total_distance\n  //       ) !== 0 && parseFloat(\n  //         this.dashBoardData.total_distance\n  //       ) !== 1001\n  //         ? ((parseFloat(this.dashBoardData.total_distance) -\n  //           parseFloat(this.dashBoardData.pre_total_distance)) /\n  //           parseFloat(this.dashBoardData.pre_total_distance)) *\n  //         100\n  //         : 0;\n  //     }\n  //     this.isLoadingshimmer = false;\n  //     this.cd.detectChanges();\n  //   }, (error) => {\n  //     this.dashBoardData = {};\n  //     this.isLoadingshimmer = false;\n  //     this.cd.detectChanges();\n  //   })\n  // }\n\n  // createQuerryparams() {\n  //   let querryParams = `organisation=${JSON.stringify(this.selectedOrgID)}`;\n  //   querryParams = querryParams + `&from_date=${moment().subtract(1, 'month').startOf('month').format('YYYY-MM-DD')}`\n  //   querryParams = querryParams + `&to_date=${moment().subtract(1, 'month').endOf('month').format('YYYY-MM-DD')}`\n  //   querryParams = querryParams + `&custom_filter=false&filter_value=4`\n  //   return querryParams;\n  // }\n\n\n  dataParse(event) {\n    event = JSON.parse(event)\n    if (event.action && event.action == 'liveFeed' && event.data) {\n      let data = event.data;\n      for (let i = 0; i < data.length; i++) {\n        if (this.interval) {\n          let key = Object.keys(this.vehicleMarkerList)\n          // if(data[i]['license_plate']=='VBB-92-F')\n          // console.log(data[i])\n          if (key.includes(String(data[i]['vehicle_id']))) {\n            this.updateMarker(data[i])\n            // console.log(data[i]);\n            \n          }\n          else {\n            this.createMarker(data[i]);\n            // console.log(data[i]);\n          }\n        }\n        else {\n          break;\n        }\n      }\n    }\n  }\n\n  resetFilter() {\n    this.selectedVehicleCategory = 'all';\n    this.selectedVehicle = 'all';\n    this.filterApply();\n  }\n\n  animatedMove(marker, t, current, moveto) {\n    var deltalat = (moveto.lat() - current.lat()) / 100;\n    var deltalng = (moveto.lng() - current.lng()) / 100;\n\n    var delay = 10 * t;\n    for (var i = 0; i < 100; i++) {\n      (function (ind) {\n        setTimeout(\n          function () {\n            var lat = marker.position.lat();\n            var lng = marker.position.lng();\n            lat += deltalat;\n            lng += deltalng;\n            let latlng = new google.maps.LatLng(lat, lng);\n            marker.setPosition(latlng);\n          }, delay * ind\n        );\n      })(i)\n    }\n\n  }\n\n  ngOnDestroy(): void {\n    //Called once, before the instance is destroyed.\n    //Add 'implements OnDestroy' to the class.\n    // this.webSocket.removeListener();\n    clearInterval(this.interval);\n    if (this.socket)\n      this.socket.removeEventListener('message', function (event) {\n        console.log('removed')\n      });\n  }\n\n}","\n<div class=\"mapSec\">\n  <div class=\"mapTitle\">\n    <h4>{{ \"sidebar.mapView\" | translate }}</h4>\n\n    <span\n      ><svg\n        width=\"20\"\n        height=\"20\"\n        viewBox=\"0 0 20 20\"\n        fill=\"none\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n      >\n        <path\n          d=\"M7.49984 18.3332H12.4998C16.6665 18.3332 18.3332 16.6665 18.3332 12.4998V7.49984C18.3332 3.33317 16.6665 1.6665 12.4998 1.6665H7.49984C3.33317 1.6665 1.6665 3.33317 1.6665 7.49984V12.4998C1.6665 16.6665 3.33317 18.3332 7.49984 18.3332Z\"\n          stroke=\"#667280\"\n          stroke-width=\"1.5\"\n          stroke-linecap=\"round\"\n          stroke-linejoin=\"round\"\n        />\n        <path\n          d=\"M8.82471 6.3999H12.358V9.94157\"\n          stroke=\"#667280\"\n          stroke-width=\"1.5\"\n          stroke-linecap=\"round\"\n          stroke-linejoin=\"round\"\n        />\n        <path\n          d=\"M12.3583 6.3999L7.6416 11.1166\"\n          stroke=\"#667280\"\n          stroke-width=\"1.5\"\n          stroke-linecap=\"round\"\n          stroke-linejoin=\"round\"\n        />\n        <path\n          d=\"M5 13.7583C8.24167 14.8416 11.7583 14.8416 15 13.7583\"\n          stroke=\"#667280\"\n          stroke-width=\"1.5\"\n          stroke-linecap=\"round\"\n          stroke-linejoin=\"round\"\n        />\n      </svg>\n    </span>\n  </div>\n \n  <div class=\"mapBox\">\n    <div id=\"map\"></div>\n  </div>\n</div>\n"]}